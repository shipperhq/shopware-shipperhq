!function(){"use strict";var e={};e.p="bundles/shqrateprovider/",window?.__sw__?.assetPath&&(e.p=window.__sw__.assetPath+"/bundles/shqrateprovider/"),function(){var e=JSON.parse('{"shqApiRefreshMethodsButton":{"buttonLabel":"Refresh Methods","success":"Erfolg","successMessage":"Verbindung wurde erfolgreich getestet","error":"Fehler","errorMessage":"Verbindung konnte nicht hergestellt werden. Bitte pr\xfcfen Sie Ihre Zugangsdaten","missingCredentials":"Bitte geben Sie zuerst API Key und Authentifizierungscodes ein"},"shqApiTestButton":{"buttonLabel":"API-Verbindung testen","success":"Erfolg","successMessage":"Erfolgreich mit ShipperHQ API verbunden","error":"Fehler","errorMessage":"Verbindung konnte nicht hergestellt werden. Bitte pr\xfcfen Sie Ihre Zugangsdaten","missingCredentials":"Bitte geben Sie zuerst API Key und Authentifizierungscodes ein"},"global":{"sw-order":{"delivery-date":{"empty":"Kein Lieferdatum verf\xfcgbar","label":"Voraussichtliches Lieferdatum"},"dispatch-date":{"empty":"Kein Versanddatum verf\xfcgbar","label":"Versanddatum"}}}}'),t=JSON.parse('{"shqApiRefreshMethodsButton":{"buttonLabel":"Reload Shipping Methods","success":"Success","successMessage":"Shipping Methods Successfully Reloaded","error":"Error","errorMessage":"Could not connect. Please check your credentials","missingCredentials":"Please enter API Key and Authentication Code first"},"shqApiTestButton":{"buttonLabel":"Test API Connection","success":"Success","successMessage":"Successfully connected to ShipperHQ API","error":"Error","errorMessage":"Could not connect to ShipperHQ API","missingCredentials":"Please enter API Key and Authentication Code first"},"global":{"sw-order":{"delivery-date":{"empty":"No delivery date available","label":"Estimated Delivery Date"},"dispatch-date":{"empty":"No dispatch date available","label":"Dispatch Date"}}}}');let s=Shopware.Classes.ApiService;var i=class extends s{constructor(e,t,s="shq-api-test"){super(e,t,s)}testConnection(e){let t=this.getBasicHeaders();return console.log("testConnection inside service"),this.httpClient.post(`_action/${this.getApiBasePath()}/test-connection`,e,{headers:t}).then(e=>s.handleResponse(e))}refreshMethods(e){let t=this.getBasicHeaders();return console.log("refreshMethods"),this.httpClient.post(`_action/${this.getApiBasePath()}/refresh-methods`,e,{headers:t}).then(e=>s.handleResponse(e))}};Shopware.Component.register("shq-api-test-button",{template:'<sw-button\n    :is-loading="isLoading"\n    variant="primary"\n    :square="false"\n    @click="check"\n>\n    {{ $tc(\'shqApiTestButton.buttonLabel\') }}\n</sw-button> ',props:["label"],inject:["ShipperHQApiService"],mixins:[Shopware.Mixin.getByName("notification")],data(){return{isLoading:!1}},computed:{pluginConfig(){let e=this.$parent;for(;void 0===e.actualConfigData;)e=e.$parent;return e.actualConfigData.null}},methods:{check(){if(!this.pluginConfig["SHQRateProvider.config.apiKey"]||!this.pluginConfig["SHQRateProvider.config.authenticationCode"]){this.createNotificationError({title:this.$tc("shqApiTestButton.error"),message:this.$tc("shqApiTestButton.missingCredentials")});return}this.isLoading=!0,this.ShipperHQApiService.testConnection({apiKey:this.pluginConfig["SHQRateProvider.config.apiKey"],authenticationCode:this.pluginConfig["SHQRateProvider.config.authenticationCode"]}).then(e=>{console.log(e),e.success?this.createNotificationSuccess({title:this.$tc("shqApiTestButton.success"),message:this.$tc("shqApiTestButton.successMessage")}):this.createNotificationError({title:this.$tc("shqApiTestButton.error"),message:e.message||this.$tc("shqApiTestButton.errorMessage")})}).catch(e=>{this.createNotificationError({title:this.$tc("shqApiTestButton.error"),message:e.message||this.$tc("shqApiTestButton.errorMessage")})}).finally(()=>{this.isLoading=!1})}}}),Shopware.Component.register("shq-api-refresh-methods-button",{template:'<sw-button\n    :is-loading="isLoading"\n    variant="primary"\n    :square="false"\n    @click="refreshMethods"\n>\n    {{ $tc(\'shqApiRefreshMethodsButton.buttonLabel\') }}\n</sw-button>\n',props:["label"],inject:["ShipperHQApiService"],mixins:[Shopware.Mixin.getByName("notification")],data(){return{isLoading:!1}},computed:{pluginConfig(){let e=this.$parent;for(;void 0===e.actualConfigData;)e=e.$parent;return e.actualConfigData.null}},methods:{async refreshMethods(){try{if(console.log("in refreshMethods in index.js"),!this.pluginConfig["SHQRateProvider.config.apiKey"]||!this.pluginConfig["SHQRateProvider.config.authenticationCode"]){this.createNotificationError({title:this.$tc("shqApiRefreshMethodsButton.error"),message:this.$tc("shqApiRefreshMethodsButton.missingCredentials")});return}this.isLoading=!0,this.processSuccess=!1;let e=await this.ShipperHQApiService.refreshMethods({apiKey:this.pluginConfig["SHQRateProvider.config.apiKey"],authenticationCode:this.pluginConfig["SHQRateProvider.config.authenticationCode"]});if(e&&e.success)this.processSuccess=!0,this.createNotificationSuccess({title:this.$tc("shqApiRefreshMethodsButton.success"),message:this.$tc("shqApiRefreshMethodsButton.successMessage")});else throw Error(e.error||"Unknown error occurred")}catch(e){console.error("Error in refresh methods:",e),this.processSuccess=!1,this.createNotificationError({title:this.$tc("shqApiRefreshMethodsButton.error"),message:e.message||this.$tc("shqApiRefreshMethodsButton.errorMessage")})}finally{this.isLoading=!1,setTimeout(()=>{this.processSuccess=!1},2500)}}}}),Shopware.Component.override("sw-order-detail-details",{template:'{% block sw_order_detail_details %}\n    {% parent %}\n    \n    <sw-card\n        class="sw-order-detail-details__shipperhq"\n        position-identifier="sw-order-detail-details-shipperhq"\n        title="ShipperHQ Information"\n    >\n        <sw-container>\n            <template v-for="delivery in order.deliveries">\n                <sw-description-list columns="1fr" grid="1fr">\n                    <dt>{{ $tc(\'global.sw-order.dispatch-date.label\') }}</dt>\n                    <dd v-if="delivery.customFields?.shipperhq_dispatch_date">\n                        <sw-text-field\n                            :value="formatDate(delivery.customFields.shipperhq_dispatch_date)"\n                            :disabled="true"\n                            :copyable="false"\n                        ></sw-text-field>\n                    </dd>\n                    <dd v-else>{{ $tc(\'global.sw-order.dispatch-date.empty\') }}</dd>\n\n                    <dt>{{ $tc(\'global.sw-order.delivery-date.label\') }}</dt>\n                    <dd v-if="delivery.customFields?.shipperhq_delivery_date">\n                        <sw-text-field\n                            :value="formatDate(delivery.customFields.shipperhq_delivery_date)"\n                            :disabled="true"\n                            :copyable="false"\n                        ></sw-text-field>\n                    </dd>\n                    <dd v-else>{{ $tc(\'global.sw-order.delivery-date.empty\') }}</dd>\n                </sw-description-list>\n            </template>\n        </sw-container>\n    </sw-card>\n\n    <style lang="scss">\n    .sw-description-list {\n        dt {\n            color: #758CA3;\n            font-size: 14px;\n            margin-bottom: 8px;\n        }\n        \n        dd {\n            font-size: 14px;\n            margin-bottom: 16px;\n        }\n    }\n    </style>\n{% endblock %} ',methods:{formatDate(e){if(!e)return"";let[t,s,i]=e.split(" "),[r,n,o]=t.split("-");return new Date(`${o}-${n}-${r}T${s}${i.slice(0,3)}:${i.slice(3)}`).toLocaleString()}}}),Shopware.Locale.extend("de-DE",e),Shopware.Locale.extend("en-GB",t),Shopware.Service().register("ShipperHQApiService",()=>new i(Shopware.Application.getContainer("init").httpClient,Shopware.Service("loginService")))}()}();